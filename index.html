<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Tariff News Timeline</title>
  <style>
    /* Basic styling for the page */
    body {
      font-family: Arial, sans-serif;
      background: #f4f4f4;
      margin: 0;
      padding: 20px;
    }
    
    h1 {
      text-align: center;
      margin-bottom: 20px;
    }
    
    /* Container for the timeline and filter controls */
    .controls {
      text-align: center;
      margin-bottom: 30px;
    }
    
    /* Timeline container */
    .timeline {
      position: relative;
      margin: 0 auto;
      padding: 20px 0;
      width: 600px;
    }
    
    /* The vertical line */
    .timeline::before {
      content: '';
      position: absolute;
      left: 30px;
      top: 0;
      bottom: 0;
      width: 4px;
      background: #ccc;
    }
    
    /* Each timeline item */
    .timeline-item {
      position: relative;
      margin: 20px 0;
      padding-left: 60px;
      background: #fff;
      padding: 10px 20px;
      border-radius: 4px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    
    /* Circle marker for each item */
    .timeline-item::before {
      content: '';
      position: absolute;
      left: 20px;
      top: 15px;
      background: #fff;
      border: 4px solid #FF5722;
      width: 20px;
      height: 20px;
      border-radius: 50%;
    }
    
    /* Article date, title, and description styling */
    .date {
      font-weight: bold;
      color: #333;
    }
    
    .title {
      font-size: 1.2em;
      margin: 5px 0;
    }
    
    .description {
      color: #666;
    }
  </style>
</head>
<body>

  <h1>Tariff News Timeline</h1>

  <div class="controls">
    <label for="startDate">Start Date:</label>
    <input type="date" id="startDate">
    <label for="endDate">End Date:</label>
    <input type="date" id="endDate">
    <button id="filterBtn">Filter Articles</button>
  </div>

  <div class="timeline" id="timeline">
    <!-- Timeline items will be rendered here -->
  </div>

  <script>
    // Function to load the JSON data from the tariffs.json file
    async function loadNews() {
      try {
        const response = await fetch('tariffs.json');
        if (!response.ok) {
          throw new Error('Network response was not ok');
        }
        const newsData = await response.json();
        return newsData;
      } catch (error) {
        console.error('Error loading news data:', error);
        return [];
      }
    }

    // Function to filter news by the provided date range
    function filterNewsByDate(newsData, startDate, endDate) {
      return newsData.filter(item => {
        const itemDate = new Date(item.date);
        return itemDate >= startDate && itemDate <= endDate;
      });
    }

    // Function to render the timeline items in the DOM
    function renderTimeline(newsItems) {
      const timelineContainer = document.getElementById('timeline');
      timelineContainer.innerHTML = '';

      if (newsItems.length === 0) {
        timelineContainer.innerHTML = '<p style="text-align:center;">No articles found for this date range.</p>';
        return;
      }

      newsItems.forEach(item => {
        const timelineItem = document.createElement('div');
        timelineItem.className = 'timeline-item';

        const dateEl = document.createElement('div');
        dateEl.className = 'date';
        dateEl.textContent = item.date;

        const titleEl = document.createElement('div');
        titleEl.className = 'title';
        titleEl.textContent = item.title;

        const descEl = document.createElement('div');
        descEl.className = 'description';
        descEl.textContent = item.description;

        timelineItem.appendChild(dateEl);
        timelineItem.appendChild(titleEl);
        timelineItem.appendChild(descEl);

        timelineContainer.appendChild(timelineItem);
      });
    }

    // Initialize the timeline on page load
    async function init() {
      const newsData = await loadNews();

      // Automatically set the date pickers to cover the entire date range available in the data
      if (newsData.length > 0) {
        let dates = newsData.map(item => new Date(item.date));
        let defaultStartDate = new Date(Math.min(...dates));
        let defaultEndDate = new Date(Math.max(...dates));

        document.getElementById('startDate').value = defaultStartDate.toISOString().split('T')[0];
        document.getElementById('endDate').value = defaultEndDate.toISOString().split('T')[0];

        // Render all news items by default
        renderTimeline(newsData);
      }

      // Set up the filtering function when the button is clicked
      document.getElementById('filterBtn').addEventListener('click', () => {
        const startDateInput = document.getElementById('startDate').value;
        const endDateInput = document.getElementById('endDate').value;

        if (!startDateInput || !endDateInput) {
          alert("Please select both start and end dates.");
          return;
        }

        const startDate = new Date(startDateInput);
        const endDate = new Date(endDateInput);
        const filteredNews = filterNewsByDate(newsData, startDate, endDate);
        renderTimeline(filteredNews);
      });
    }

    init();
  </script>
</body>
</html>
